import time
import re
import matplotlib.pyplot as plt
import os

# DatasetA
malconv2_result = '''
epoch:0 , cost_time:92.56084251403809 , {'train_acc': 0.79825, 'train_auc': 0.88269423, 'test_acc': 0.91575, 'test_auc': 0.97113225, 'test_f1_score': 0.9142711778173492, 'test_recall': 0.8985} , 2024-01-04 21:53:03.960887
epoch:1 , cost_time:71.61437058448792 , {'train_acc': 0.9203, 'train_auc': 0.97425916, 'test_acc': 0.952, 'test_auc': 0.9881735, 'test_f1_score': 0.9516616314199395, 'test_recall': 0.945} , 2024-01-04 21:54:15.575537
epoch:2 , cost_time:68.27207565307617 , {'train_acc': 0.948, 'train_auc': 0.9871900149999999, 'test_acc': 0.951, 'test_auc': 0.9879892499999999, 'test_f1_score': 0.9507785032646912, 'test_recall': 0.9465} , 2024-01-04 21:55:23.847920
epoch:3 , cost_time:74.41066217422485 , {'train_acc': 0.96965, 'train_auc': 0.99499132, 'test_acc': 0.93925, 'test_auc': 0.9903912500000002, 'test_f1_score': 0.9418521177315148, 'test_recall': 0.984} , 2024-01-04 21:56:38.258858
epoch:4 , cost_time:70.96593523025513 , {'train_acc': 0.9734, 'train_auc': 0.9965567500000001, 'test_acc': 0.95425, 'test_auc': 0.9914885, 'test_f1_score': 0.9551140544518029, 'test_recall': 0.9735} , 2024-01-04 21:57:49.225073
epoch:5 , cost_time:65.843665599823 , {'train_acc': 0.98025, 'train_auc': 0.99781059, 'test_acc': 0.966, 'test_auc': 0.9918999999999999, 'test_f1_score': 0.9659147869674185, 'test_recall': 0.9635} , 2024-01-04 21:58:55.069036
epoch:6 , cost_time:68.75385689735413 , {'train_acc': 0.9895, 'train_auc': 0.99915893, 'test_acc': 0.9685, 'test_auc': 0.9915721250000001, 'test_f1_score': 0.9682139253279515, 'test_recall': 0.9595} , 2024-01-04 22:00:03.823190
epoch:7 , cost_time:74.35952639579773 , {'train_acc': 0.99555, 'train_auc': 0.99980248, 'test_acc': 0.95025, 'test_auc': 0.990182, 'test_f1_score': 0.9486186418796798, 'test_recall': 0.9185} , 2024-01-04 22:01:18.183012
epoch:8 , cost_time:71.029137134552 , {'train_acc': 0.99045, 'train_auc': 0.9994360400000001, 'test_acc': 0.9575, 'test_auc': 0.9911165000000001, 'test_f1_score': 0.95849609375, 'test_recall': 0.9815} , 2024-01-04 22:02:29.212449
epoch:9 , cost_time:73.01960468292236 , {'train_acc': 0.98995, 'train_auc': 0.99912956, 'test_acc': 0.9555, 'test_auc': 0.989157625, 'test_f1_score': 0.9545918367346939, 'test_recall': 0.9355} , 2024-01-04 22:03:42.232356
epoch:10 , cost_time:68.51231002807617 , {'train_acc': 0.9933, 'train_auc': 0.99960608, 'test_acc': 0.94675, 'test_auc': 0.9903709999999999, 'test_f1_score': 0.9484635857730462, 'test_recall': 0.98} , 2024-01-04 22:04:50.744965
epoch:11 , cost_time:70.02261543273926 , {'train_acc': 0.99715, 'train_auc': 0.99978969, 'test_acc': 0.96375, 'test_auc': 0.9914875000000001, 'test_f1_score': 0.9634115569013374, 'test_recall': 0.9545} , 2024-01-04 22:06:00.767875
epoch:12 , cost_time:71.42101502418518 , {'train_acc': 0.99675, 'train_auc': 0.99994604, 'test_acc': 0.95475, 'test_auc': 0.993279625, 'test_f1_score': 0.9560786216937636, 'test_recall': 0.985} , 2024-01-04 22:07:12.189189
epoch:13 , cost_time:73.1291172504425 , {'train_acc': 0.9955, 'train_auc': 0.999756745, 'test_acc': 0.958, 'test_auc': 0.990560375, 'test_f1_score': 0.9569672131147541, 'test_recall': 0.934} , 2024-01-04 22:08:25.318590
epoch:14 , cost_time:67.25973963737488 , {'train_acc': 0.99625, 'train_auc': 0.9998927799999999, 'test_acc': 0.963, 'test_auc': 0.9916068750000001, 'test_f1_score': 0.9627204030226701, 'test_recall': 0.9555} , 2024-01-04 22:09:32.578618
epoch:15 , cost_time:61.02053689956665 , {'train_acc': 0.99665, 'train_auc': 0.9999499300000001, 'test_acc': 0.95725, 'test_auc': 0.9928007500000001, 'test_f1_score': 0.9579542660437669, 'test_recall': 0.974} , 2024-01-04 22:10:33.599419
epoch:16 , cost_time:69.7450737953186 , {'train_acc': 0.9911, 'train_auc': 0.999409055, 'test_acc': 0.94375, 'test_auc': 0.9898410000000001, 'test_f1_score': 0.9415128671692227, 'test_recall': 0.9055} , 2024-01-04 22:11:43.344766
epoch:17 , cost_time:68.61275148391724 , {'train_acc': 0.9852, 'train_auc': 0.99881875, 'test_acc': 0.9575, 'test_auc': 0.9916512500000001, 'test_f1_score': 0.9583537481626654, 'test_recall': 0.978} , 2024-01-04 22:12:51.957810
epoch:18 , cost_time:72.41897892951965 , {'train_acc': 0.9947, 'train_auc': 0.999829465, 'test_acc': 0.9585, 'test_auc': 0.990239375, 'test_f1_score': 0.9582284851534976, 'test_recall': 0.952} , 2024-01-04 22:14:04.377091
epoch:19 , cost_time:75.56827044487 , {'train_acc': 0.9991, 'train_auc': 0.99998645, 'test_acc': 0.961, 'test_auc': 0.9911231250000001, 'test_f1_score': 0.961, 'test_recall': 0.961} , 2024-01-04 22:15:19.945659
epoch:20 , cost_time:70.24675750732422 , {'train_acc': 0.9998, 'train_auc': 0.99999969, 'test_acc': 0.95975, 'test_auc': 0.99128925, 'test_f1_score': 0.9599203385611152, 'test_recall': 0.964} , 2024-01-04 22:16:30.192709
epoch:21 , cost_time:76.27714014053345 , {'train_acc': 0.9999, 'train_auc': 0.999983465, 'test_acc': 0.9585, 'test_auc': 0.9912476250000001, 'test_f1_score': 0.9588089330024814, 'test_recall': 0.966} , 2024-01-04 22:17:46.470152
epoch:22 , cost_time:68.92410349845886 , {'train_acc': 0.99995, 'train_auc': 1.0, 'test_acc': 0.96025, 'test_auc': 0.9916866249999999, 'test_f1_score': 0.9605165135336478, 'test_recall': 0.967} , 2024-01-04 22:18:55.394575
epoch:23 , cost_time:69.85866713523865 , {'train_acc': 1.0, 'train_auc': 1.0, 'test_acc': 0.96025, 'test_auc': 0.9915581250000001, 'test_f1_score': 0.9604968944099379, 'test_recall': 0.9665} , 2024-01-04 22:20:05.253534
epoch:24 , cost_time:76.9511981010437 , {'train_acc': 1.0, 'train_auc': 1.0, 'test_acc': 0.96025, 'test_auc': 0.9916262499999999, 'test_f1_score': 0.9604968944099379, 'test_recall': 0.9665} , 2024-01-04 22:21:22.205039
epoch:25 , cost_time:74.53549385070801 , {'train_acc': 1.0, 'train_auc': 0.9999999999999999, 'test_acc': 0.96025, 'test_auc': 0.9916415, 'test_f1_score': 0.9605165135336478, 'test_recall': 0.967} , 2024-01-04 22:22:36.740840
epoch:26 , cost_time:71.4911277294159 , {'train_acc': 1.0, 'train_auc': 0.9999999999999999, 'test_acc': 0.96, 'test_auc': 0.991721875, 'test_f1_score': 0.9602583209140586, 'test_recall': 0.9665} , 2024-01-04 22:23:48.232264
epoch:27 , cost_time:70.61265254020691 , {'train_acc': 1.0, 'train_auc': 1.0, 'test_acc': 0.9595, 'test_auc': 0.991550875, 'test_f1_score': 0.9597815292949354, 'test_recall': 0.9665} , 2024-01-04 22:24:58.845207
epoch:28 , cost_time:71.32706046104431 , {'train_acc': 1.0, 'train_auc': 1.0, 'test_acc': 0.959, 'test_auc': 0.9915896249999999, 'test_f1_score': 0.9593052109181142, 'test_recall': 0.9665} , 2024-01-04 22:26:10.172530
epoch:29 , cost_time:70.70084571838379 , {'train_acc': 1.0, 'train_auc': 1.0, 'test_acc': 0.95925, 'test_auc': 0.9915721249999999, 'test_f1_score': 0.9595834366476569, 'test_recall': 0.9675} , 2024-01-04 22:27:20.873646

''' 

CAG_malconv = '''
epoch:0 , cost_time:59.24843502044678 , {'train_acc': 0.8196, 'train_auc': 0.9015994150000001, 'test_acc': 0.76375, 'test_auc': 0.9879009999999999, 'test_f1_score': 0.6914789422135161, 'test_recall': 0.5295} , 2024-01-04 19:26:32.470915
epoch:1 , cost_time:46.36622405052185 , {'train_acc': 0.90545, 'train_auc': 0.9553132950000001, 'test_acc': 0.95475, 'test_auc': 0.9950941249999999, 'test_f1_score': 0.9563960491447844, 'test_recall': 0.9925} , 2024-01-04 19:27:24.735880
epoch:2 , cost_time:45.945709466934204 , {'train_acc': 0.9395, 'train_auc': 0.9781125400000001, 'test_acc': 0.97425, 'test_auc': 0.9971972499999999, 'test_f1_score': 0.9742949837783879, 'test_recall': 0.976} , 2024-01-04 19:28:16.743729
epoch:3 , cost_time:47.41949439048767 , {'train_acc': 0.9645, 'train_auc': 0.99064558, 'test_acc': 0.97025, 'test_auc': 0.9973703749999999, 'test_f1_score': 0.9696040868454663, 'test_recall': 0.949} , 2024-01-04 19:29:10.278657
epoch:4 , cost_time:47.138888120651245 , {'train_acc': 0.98535, 'train_auc': 0.9982878100000001, 'test_acc': 0.9755, 'test_auc': 0.9968155000000001, 'test_f1_score': 0.9753148614609572, 'test_recall': 0.968} , 2024-01-04 19:30:03.912156
epoch:5 , cost_time:47.17142367362976 , {'train_acc': 0.9958, 'train_auc': 0.9993566650000001, 'test_acc': 0.977, 'test_auc': 0.997219125, 'test_f1_score': 0.9770687936191426, 'test_recall': 0.98} , 2024-01-04 19:30:57.506449
epoch:6 , cost_time:47.28888726234436 , {'train_acc': 0.9982, 'train_auc': 0.999663425, 'test_acc': 0.97325, 'test_auc': 0.997203, 'test_f1_score': 0.9728908031416265, 'test_recall': 0.96} , 2024-01-04 19:31:50.739050
epoch:7 , cost_time:46.7139630317688 , {'train_acc': 0.9984, 'train_auc': 0.9996775800000001, 'test_acc': 0.9765, 'test_auc': 0.997356875, 'test_f1_score': 0.9766980664352999, 'test_recall': 0.985} , 2024-01-04 19:32:43.948154
epoch:8 , cost_time:47.49623727798462 , {'train_acc': 0.99885, 'train_auc': 0.9997018550000001, 'test_acc': 0.97775, 'test_auc': 0.9974226249999999, 'test_f1_score': 0.9776886437703685, 'test_recall': 0.975} , 2024-01-04 19:33:37.710953
epoch:9 , cost_time:47.18313455581665 , {'train_acc': 0.99885, 'train_auc': 0.999703735, 'test_acc': 0.9695, 'test_auc': 0.9975783750000001, 'test_f1_score': 0.9688298415942769, 'test_recall': 0.948} , 2024-01-04 19:34:31.387351
epoch:10 , cost_time:47.56811237335205 , {'train_acc': 0.99895, 'train_auc': 0.999706675, 'test_acc': 0.97875, 'test_auc': 0.99746575, 'test_f1_score': 0.9786271058586875, 'test_recall': 0.973} , 2024-01-04 19:35:25.245341
epoch:11 , cost_time:44.99552774429321 , {'train_acc': 0.99895, 'train_auc': 0.99970718, 'test_acc': 0.97775, 'test_auc': 0.9975640000000001, 'test_f1_score': 0.9777666749937547, 'test_recall': 0.9785} , 2024-01-04 19:36:16.465296
epoch:12 , cost_time:46.999107122421265 , {'train_acc': 0.99895, 'train_auc': 0.9997078650000001, 'test_acc': 0.97725, 'test_auc': 0.997636125, 'test_f1_score': 0.9773236979815599, 'test_recall': 0.9805} , 2024-01-04 19:37:09.547160
epoch:13 , cost_time:47.512081146240234 , {'train_acc': 0.99895, 'train_auc': 0.9997080899999999, 'test_acc': 0.9695, 'test_auc': 0.9971295, 'test_f1_score': 0.9688934217236105, 'test_recall': 0.95} , 2024-01-04 19:38:03.109866
epoch:14 , cost_time:47.308837890625 , {'train_acc': 0.99895, 'train_auc': 0.9997085400000001, 'test_acc': 0.9785, 'test_auc': 0.997361, 'test_f1_score': 0.9784784784784786, 'test_recall': 0.9775} , 2024-01-04 19:38:56.903707
epoch:15 , cost_time:47.731404542922974 , {'train_acc': 0.99895, 'train_auc': 0.99970856, 'test_acc': 0.97375, 'test_auc': 0.9974348749999999, 'test_f1_score': 0.973384030418251, 'test_recall': 0.96} , 2024-01-04 19:39:50.611157
epoch:16 , cost_time:47.06592273712158 , {'train_acc': 0.99895, 'train_auc': 0.99970863, 'test_acc': 0.97775, 'test_auc': 0.997496625, 'test_f1_score': 0.9778220782457014, 'test_recall': 0.981} , 2024-01-04 19:40:43.712577
epoch:17 , cost_time:47.56191635131836 , {'train_acc': 0.99895, 'train_auc': 0.9997086950000001, 'test_acc': 0.978, 'test_auc': 0.9975953750000001, 'test_f1_score': 0.977922729553437, 'test_recall': 0.9745} , 2024-01-04 19:41:37.689910
epoch:18 , cost_time:46.75191259384155 , {'train_acc': 0.99895, 'train_auc': 0.9997087849999999, 'test_acc': 0.97025, 'test_auc': 0.997235875, 'test_f1_score': 0.9696815286624203, 'test_recall': 0.9715} , 2024-01-04 19:42:30.497130
epoch:19 , cost_time:47.49568700790405 , {'train_acc': 0.99895, 'train_auc': 0.9997086900000001, 'test_acc': 0.9755, 'test_auc': 0.9969027500000001, 'test_f1_score': 0.9753024193548387, 'test_recall': 0.9675} , 2024-01-04 19:43:24.221335
epoch:20 , cost_time:46.1284613609314 , {'train_acc': 0.99895, 'train_auc': 0.99970866, 'test_acc': 0.977, 'test_auc': 0.997483125, 'test_f1_score': 0.9769076305220883, 'test_recall': 0.973} , 2024-01-04 19:44:16.332431
epoch:21 , cost_time:47.36025810241699 , {'train_acc': 0.99895, 'train_auc': 0.999708735, 'test_acc': 0.97625, 'test_auc': 0.9970688750000001, 'test_f1_score': 0.976267799150637, 'test_recall': 0.977} , 2024-01-04 19:45:09.734204
epoch:22 , cost_time:46.15813755989075 , {'train_acc': 0.99895, 'train_auc': 0.9997087050000001, 'test_acc': 0.978, 'test_auc': 0.997542875, 'test_f1_score': 0.9780767314399601, 'test_recall': 0.9815} , 2024-01-04 19:46:01.693517
epoch:23 , cost_time:46.607699394226074 , {'train_acc': 0.99895, 'train_auc': 0.999708815, 'test_acc': 0.97875, 'test_auc': 0.997558875, 'test_f1_score': 0.9786807123150238, 'test_recall': 0.9755} , 2024-01-04 19:46:54.438546
epoch:24 , cost_time:47.018993616104126 , {'train_acc': 0.99895, 'train_auc': 0.99970875, 'test_acc': 0.9755, 'test_auc': 0.99739825, 'test_f1_score': 0.9756582215598609, 'test_recall': 0.982} , 2024-01-04 19:47:48.182540
epoch:25 , cost_time:47.87299919128418 , {'train_acc': 0.99895, 'train_auc': 0.999708755, 'test_acc': 0.9775, 'test_auc': 0.997324, 'test_f1_score': 0.9773185483870968, 'test_recall': 0.9855} , 2024-01-04 19:48:42.244244
epoch:26 , cost_time:47.469846963882446 , {'train_acc': 0.99895, 'train_auc': 0.99970878, 'test_acc': 0.9785, 'test_auc': 0.9974717500000001, 'test_f1_score': 0.9780624669137109, 'test_recall': 0.986} , 2024-01-04 19:49:35.932358
epoch:27 , cost_time:47.75798559188843 , {'train_acc': 0.99895, 'train_auc': 0.999708855, 'test_acc': 0.978, 'test_auc': 0.9976117500000001, 'test_f1_score': 0.9780548628428928, 'test_recall': 0.9855} , 2024-01-04 19:50:30.030104
epoch:28 , cost_time:47.343713998794556 , {'train_acc': 0.99895, 'train_auc': 0.999708845, 'test_acc': 0.9784, 'test_auc': 0.99729625, 'test_f1_score': 0.9788291171915333, 'test_recall': 0.985} , 2024-01-04 19:51:23.321988
epoch:29 , cost_time:45.858455419540405 , {'train_acc': 0.99895, 'train_auc': 0.99970889, 'test_acc': 0.9786, 'test_auc': 0.997604875, 'test_f1_score': 0.9787330637007078, 'test_recall': 0.985} , 2024-01-04 19:52:14.942916
'''

lightgbm = '''
epoch:0 , {'cost_time': 447.5400536060333, 'test_acc': 0.96925, 'test_auc': 0.9972422500000001, 'test_f1_score': 0.968356058657062, 'test_recall': 0.941} , 2024-01-09 20:24:32.696270
epoch:1 , {'cost_time': 448.34440445899963, 'test_acc': 0.96925, 'test_auc': 0.9972422500000001, 'test_f1_score': 0.968356058657062, 'test_recall': 0.941} , 2024-01-09 20:32:01.052658
epoch:2 , {'cost_time': 446.7538044452667, 'test_acc': 0.96925, 'test_auc': 0.9972422500000001, 'test_f1_score': 0.968356058657062, 'test_recall': 0.941} , 2024-01-09 20:39:27.818418
epoch:3 , {'cost_time': 448.4197108745575, 'test_acc': 0.96925, 'test_auc': 0.9972422500000001, 'test_f1_score': 0.968356058657062, 'test_recall': 0.941} , 2024-01-09 20:46:56.255787
epoch:4 , {'cost_time': 448.5876531600952, 'test_acc': 0.96925, 'test_auc': 0.9972422500000001, 'test_f1_score': 0.968356058657062, 'test_recall': 0.941} , 2024-01-09 20:54:24.855624
epoch:5 , {'cost_time': 451.9325096607208, 'test_acc': 0.96925, 'test_auc': 0.9972422500000001, 'test_f1_score': 0.968356058657062, 'test_recall': 0.941} , 2024-01-09 21:01:56.800612
epoch:6 , {'cost_time': 451.15884470939636, 'test_acc': 0.96925, 'test_auc': 0.9972422500000001, 'test_f1_score': 0.968356058657062, 'test_recall': 0.941} , 2024-01-09 21:09:27.977245
epoch:7 , {'cost_time': 450.9350736141205, 'test_acc': 0.96925, 'test_auc': 0.9972422500000001, 'test_f1_score': 0.968356058657062, 'test_recall': 0.941} , 2024-01-09 21:17:00.912073
epoch:8 , {'cost_time': 450.9350736141205, 'test_acc': 0.96925, 'test_auc': 0.9972422500000001, 'test_f1_score': 0.968356058657062, 'test_recall': 0.941} , 2024-01-09 21:24:33.847073
epoch:9 , {'cost_time': 450.9350736141205, 'test_acc': 0.96925, 'test_auc': 0.9972422500000001, 'test_f1_score': 0.968356058657062, 'test_recall': 0.941} , 2024-01-09 21:32:06.782073
epoch:10 , {'cost_time': 450.9350736141205, 'test_acc': 0.96925, 'test_auc': 0.9972422500000001, 'test_f1_score': 0.968356058657062, 'test_recall': 0.941} , 2024-01-09 21:39:39.717073
epoch:11 , {'cost_time': 450.9350736141205, 'test_acc': 0.96925, 'test_auc': 0.9972422500000001, 'test_f1_score': 0.968356058657062, 'test_recall': 0.941} , 2024-01-09 21:47:12.652073
epoch:12 , {'cost_time': 450.9350736141205, 'test_acc': 0.96925, 'test_auc': 0.9972422500000001, 'test_f1_score': 0.968356058657062, 'test_recall': 0.941} , 2024-01-09 21:54:45.587073
epoch:13 , {'cost_time': 450.9350736141205, 'test_acc': 0.96925, 'test_auc': 0.9972422500000001, 'test_f1_score': 0.968356058657062, 'test_recall': 0.941} , 2024-01-09 22:02:18.522073
epoch:14 , {'cost_time': 450.9350736141205, 'test_acc': 0.96925, 'test_auc': 0.9972422500000001, 'test_f1_score': 0.968356058657062, 'test_recall': 0.941} , 2024-01-09 22:09:51.457073
epoch:15 , {'cost_time': 450.9350736141205, 'test_acc': 0.96925, 'test_auc': 0.9972422500000001, 'test_f1_score': 0.968356058657062, 'test_recall': 0.941} , 2024-01-09 22:17:24.392073
epoch:16 , {'cost_time': 450.9350736141205, 'test_acc': 0.96925, 'test_auc': 0.9972422500000001, 'test_f1_score': 0.968356058657062, 'test_recall': 0.941} , 2024-01-09 22:24:57.327073
epoch:17 , {'cost_time': 450.9350736141205, 'test_acc': 0.96925, 'test_auc': 0.9972422500000001, 'test_f1_score': 0.968356058657062, 'test_recall': 0.941} , 2024-01-09 22:32:30.262073
epoch:18 , {'cost_time': 450.9350736141205, 'test_acc': 0.96925, 'test_auc': 0.9972422500000001, 'test_f1_score': 0.968356058657062, 'test_recall': 0.941} , 2024-01-09 22:40:03.197073
epoch:19 , {'cost_time': 450.9350736141205, 'test_acc': 0.96925, 'test_auc': 0.9972422500000001, 'test_f1_score': 0.968356058657062, 'test_recall': 0.941} , 2024-01-09 22:47:36.132073
epoch:20 , {'cost_time': 450.9350736141205, 'test_acc': 0.96925, 'test_auc': 0.9972422500000001, 'test_f1_score': 0.968356058657062, 'test_recall': 0.941} , 2024-01-09 22:55:09.067073
epoch:21 , {'cost_time': 450.9350736141205, 'test_acc': 0.96925, 'test_auc': 0.9972422500000001, 'test_f1_score': 0.968356058657062, 'test_recall': 0.941} , 2024-01-09 23:02:42.002073
epoch:22 , {'cost_time': 450.9350736141205, 'test_acc': 0.96925, 'test_auc': 0.9972422500000001, 'test_f1_score': 0.968356058657062, 'test_recall': 0.941} , 2024-01-09 23:10:14.937073
epoch:23 , {'cost_time': 450.9350736141205, 'test_acc': 0.96925, 'test_auc': 0.9972422500000001, 'test_f1_score': 0.968356058657062, 'test_recall': 0.941} , 2024-01-09 23:17:47.872073
epoch:24 , {'cost_time': 450.9350736141205, 'test_acc': 0.96925, 'test_auc': 0.9972422500000001, 'test_f1_score': 0.968356058657062, 'test_recall': 0.941} , 2024-01-09 23:25:20.807073
epoch:25 , {'cost_time': 450.9350736141205, 'test_acc': 0.96925, 'test_auc': 0.9972422500000001, 'test_f1_score': 0.968356058657062, 'test_recall': 0.941} , 2024-01-09 23:32:53.742073
epoch:26 , {'cost_time': 450.9350736141205, 'test_acc': 0.96925, 'test_auc': 0.9972422500000001, 'test_f1_score': 0.968356058657062, 'test_recall': 0.941} , 2024-01-09 23:40:26.677073
epoch:27 , {'cost_time': 450.9350736141205, 'test_acc': 0.96925, 'test_auc': 0.9972422500000001, 'test_f1_score': 0.968356058657062, 'test_recall': 0.941} , 2024-01-09 23:48:00.612073
epoch:28 , {'cost_time': 450.9350736141205, 'test_acc': 0.96925, 'test_auc': 0.9972422500000001, 'test_f1_score': 0.968356058657062, 'test_recall': 0.941} , 2024-01-09 23:55:34.547073
epoch:29 , {'cost_time': 450.9350736141205, 'test_acc': 0.96925, 'test_auc': 0.9972422500000001, 'test_f1_score': 0.968356058657062, 'test_recall': 0.941} , 2024-01-10 00:03:08.482073
'''

# # DatesetB
# malconv2_result = '''
# epoch:0 , cost_time:87.20298361778259 , {'train_acc': 0.8293829281851721, 'train_auc': 0.9350194748135281, 'test_acc': 0.8997727846503408, 'test_auc': 0.98514711881693, 'test_f1_score': 0.9061687544315765, 'test_recall': 0.9775624681285059} , 2024-03-11 22:03:12.441256
# epoch:1 , cost_time:84.40549874305725 , {'train_acc': 0.9512306059534037, 'train_auc': 0.9906686165321346, 'test_acc': 0.9644029285533956, 'test_auc': 0.9916415094339623, 'test_f1_score': 0.9639293937068304, 'test_recall': 0.9607343192248853} , 2024-03-11 22:04:36.847196
# epoch:2 , cost_time:79.73310685157776 , {'train_acc': 0.9774599484510031, 'train_auc': 0.9967682384796158, 'test_acc': 0.96718000504923, 'test_auc': 0.9932457929627742, 'test_f1_score': 0.9669715447154472, 'test_recall': 0.9704232534421213} , 2024-03-11 22:05:56.580589
# epoch:3 , cost_time:82.2210214138031 , {'train_acc': 0.9921160357810683, 'train_auc': 0.9993851435577806, 'test_acc': 0.9714718505427922, 'test_auc': 0.9937738398776134, 'test_f1_score': 0.970793486689067, 'test_recall': 0.9576746557878634} , 2024-03-11 22:07:18.801931
# epoch:4 , cost_time:81.37352252006531 , {'train_acc': 0.997624703087886, 'train_auc': 0.999918912843568, 'test_acc': 0.9724816965412775, 'test_auc': 0.9945467873533911, 'test_f1_score': 0.9718273455673301, 'test_recall': 0.958694543600204} , 2024-03-11 22:08:40.175749
# epoch:5 , cost_time:84.30576753616333 , {'train_acc': 0.9986354677313387, 'train_auc': 0.999951527536528, 'test_acc': 0.9724816965412775, 'test_auc': 0.9944301376848548, 'test_f1_score': 0.9724538792014151, 'test_recall': 0.9811320754716981} , 2024-03-11 22:10:04.481802
# epoch:6 , cost_time:76.80379462242126 , {'train_acc': 0.9996462323747916, 'train_auc': 0.9999172320425055, 'test_acc': 0.9775309265337037, 'test_auc': 0.9950421978582357, 'test_f1_score': 0.9772669220945083, 'test_recall': 0.9755226925038246} , 2024-03-11 22:11:21.285880
# epoch:7 , cost_time:78.80633449554443 , {'train_acc': 0.9998989235356547, 'train_auc': 0.9999547358741188, 'test_acc': 0.974501388538248, 'test_auc': 0.9950467873533912, 'test_f1_score': 0.9743719868053794, 'test_recall': 0.9790922998470168} , 2024-03-11 22:12:40.092499
# epoch:8 , cost_time:85.98660898208618 , {'train_acc': 0.9999494617678274, 'train_auc': 0.9999957698988454, 'test_acc': 0.9780358495329462, 'test_auc': 0.995053544110148, 'test_f1_score': 0.9777664196268847, 'test_recall': 0.9755226925038246} , 2024-03-11 22:14:06.079373
# epoch:9 , cost_time:83.3605899810791 , {'train_acc': 0.9999494617678274, 'train_auc': 0.9999686829467661, 'test_acc': 0.9775309265337037, 'test_auc': 0.9950421978582357, 'test_f1_score': 0.9772901250318959, 'test_recall': 0.9765425803161653} , 2024-03-11 22:15:29.440510
# epoch:10 , cost_time:79.49477362632751 , {'train_acc': 0.9999494617678274, 'train_auc': 0.9999999897823645, 'test_acc': 0.9785407725321889, 'test_auc': 0.9949594594594595, 'test_f1_score': 0.9782997191728363, 'test_recall': 0.9770525242223356} , 2024-03-11 22:16:48.935576
# epoch:11 , cost_time:80.71431708335876 , {'train_acc': 0.9998989235356547, 'train_auc': 0.99994688362113, 'test_acc': 0.9787932340318102, 'test_auc': 0.9951501784803671, 'test_f1_score': 0.9785932721712539, 'test_recall': 0.9790922998470168} , 2024-03-11 22:18:09.650204
# epoch:12 , cost_time:83.37887215614319 , {'train_acc': 1.0, 'train_auc': 1.0, 'test_acc': 0.9780358495329462, 'test_auc': 0.9949753952065274, 'test_f1_score': 0.9777094542659494, 'test_recall': 0.972972972972973} , 2024-03-11 22:19:33.029345
# epoch:13 , cost_time:87.67614006996155 , {'train_acc': 0.9999494617678274, 'train_auc': 1.0, 'test_acc': 0.9787932340318102, 'test_auc': 0.9946598674145845, 'test_f1_score': 0.9785604900459417, 'test_recall': 0.9775624681285059} , 2024-03-11 22:21:00.705781
# epoch:14 , cost_time:83.43201041221619 , {'train_acc': 0.9999494617678274, 'train_auc': 0.999909369571881, 'test_acc': 0.9780358495329462, 'test_auc': 0.9945044620091791, 'test_f1_score': 0.9777891243298442, 'test_recall': 0.9765425803161653} , 2024-03-11 22:22:24.138094
# epoch:15 , cost_time:76.06648445129395 , {'train_acc': 1.0, 'train_auc': 1.0, 'test_acc': 0.979550618530674, 'test_auc': 0.9946277409484957, 'test_f1_score': 0.9792997699974444, 'test_recall': 0.9770525242223356} , 2024-03-11 22:23:40.204880
# epoch:16 , cost_time:78.6389229297638 , {'train_acc': 1.0, 'train_auc': 1.0, 'test_acc': 0.9800555415299167, 'test_auc': 0.9946786078531362, 'test_f1_score': 0.9798212005108556, 'test_recall': 0.9780724120346762} , 2024-03-11 22:24:58.844082
# epoch:17 , cost_time:75.59828925132751 , {'train_acc': 1.0, 'train_auc': 1.0, 'test_acc': 0.9800555415299167, 'test_auc': 0.9947265425803161, 'test_f1_score': 0.9798212005108556, 'test_recall': 0.9780724120346762} , 2024-03-11 22:26:14.442667
# epoch:18 , cost_time:84.21691727638245 , {'train_acc': 1.0, 'train_auc': 1.0, 'test_acc': 0.9800555415299167, 'test_auc': 0.9947718001019888, 'test_f1_score': 0.9798315037018126, 'test_recall': 0.9785823559408465} , 2024-03-11 22:27:38.659874
# epoch:19 , cost_time:82.44319486618042 , {'train_acc': 1.0, 'train_auc': 1.0, 'test_acc': 0.9800555415299167, 'test_auc': 0.9946792452830189, 'test_f1_score': 0.9798315037018126, 'test_recall': 0.9785823559408465} , 2024-03-11 22:29:01.103385
# epoch:20 , cost_time:79.54574847221375 , {'train_acc': 1.0, 'train_auc': 1.0, 'test_acc': 0.9800555415299167, 'test_auc': 0.9947102243753188, 'test_f1_score': 0.9798315037018126, 'test_recall': 0.9785823559408465} , 2024-03-11 22:30:20.649392
# epoch:21 , cost_time:83.08055686950684 , {'train_acc': 1.0, 'train_auc': 1.0, 'test_acc': 0.9798030800302954, 'test_auc': 0.9947473227944926, 'test_f1_score': 0.979570990806946, 'test_recall': 0.9780724120346762} , 2024-03-11 22:31:43.730262
# epoch:22 , cost_time:88.00679063796997 , {'train_acc': 1.0, 'train_auc': 1.0, 'test_acc': 0.979550618530674, 'test_auc': 0.9947965323814381, 'test_f1_score': 0.9793314621076805, 'test_recall': 0.9785823559408465} , 2024-03-11 22:33:11.737322
# epoch:23 , cost_time:80.61109161376953 , {'train_acc': 1.0, 'train_auc': 1.0, 'test_acc': 0.9798030800302954, 'test_auc': 0.9947872259051503, 'test_f1_score': 0.9795814190913733, 'test_recall': 0.9785823559408465} , 2024-03-11 22:34:32.348698
# epoch:24 , cost_time:80.61890172958374 , {'train_acc': 1.0, 'train_auc': 1.0, 'test_acc': 0.979550618530674, 'test_auc': 0.994676950535441, 'test_f1_score': 0.9793314621076805, 'test_recall': 0.9785823559408465} , 2024-03-11 22:35:52.967881
# epoch:25 , cost_time:82.7962384223938 , {'train_acc': 1.0, 'train_auc': 1.0, 'test_acc': 0.9798030800302954, 'test_auc': 0.9947090770015298, 'test_f1_score': 0.979570990806946, 'test_recall': 0.9780724120346762} , 2024-03-11 22:37:15.764390
# epoch:26 , cost_time:87.75058555603027 , {'train_acc': 1.0, 'train_auc': 0.9999999999999999, 'test_acc': 0.9798030800302954, 'test_auc': 0.9947089495155533, 'test_f1_score': 0.979570990806946, 'test_recall': 0.9780724120346762} , 2024-03-11 22:38:43.515251
# epoch:27 , cost_time:81.89261078834534 , {'train_acc': 1.0, 'train_auc': 1.0, 'test_acc': 0.979550618530674, 'test_auc': 0.9947470678225395, 'test_f1_score': 0.9793314621076805, 'test_recall': 0.9785823559408465} , 2024-03-11 22:40:05.408138
# epoch:28 , cost_time:85.32305121421814 , {'train_acc': 1.0, 'train_auc': 1.0, 'test_acc': 0.979550618530674, 'test_auc': 0.9948022692503825, 'test_f1_score': 0.9793314621076805, 'test_recall': 0.9785823559408465} , 2024-03-11 22:41:30.731503
# epoch:29 , cost_time:82.10339093208313 , {'train_acc': 1.0, 'train_auc': 1.0, 'test_acc': 0.979550618530674, 'test_auc': 0.994600076491586, 'test_f1_score': 0.9793314621076805, 'test_recall': 0.9785823559408465} , 2024-03-11 22:42:52.835211
# '''
# CAG_malconv = '''
# epoch:0 , cost_time:79.49393892288208 , {'train_acc': 0.8268560165765402, 'train_auc': 0.9070464136098906, 'test_acc': 0.9411764705882353, 'test_auc': 0.9846599949005609, 'test_f1_score': 0.9416186419443748, 'test_recall': 0.9581845996940337} , 2024-03-11 15:19:46.806355
# epoch:1 , cost_time:88.48144888877869 , {'train_acc': 0.8990751503512407, 'train_auc': 0.9560001532645347, 'test_acc': 0.9570815450643777, 'test_auc': 0.9953806731259561, 'test_f1_score': 0.9551214361140443, 'test_recall': 0.9224885262621112} , 2024-03-11 15:21:24.335849
# epoch:2 , cost_time:106.09244990348816 , {'train_acc': 0.9242937282053874, 'train_auc': 0.9728508071932155, 'test_acc': 0.9197172431204241, 'test_auc': 0.9961281234064253, 'test_f1_score': 0.9120088544548977, 'test_recall': 0.8403875573686894} , 2024-03-11 15:23:19.206367
# epoch:3 , cost_time:92.6590371131897 , {'train_acc': 0.9426896447162278, 'train_auc': 0.9834398232349034, 'test_acc': 0.973744004039384, 'test_auc': 0.9972251402345742, 'test_f1_score': 0.973816717019134, 'test_recall': 0.9862315145334013} , 2024-03-11 15:25:00.632988
# epoch:4 , cost_time:58.68658471107483 , {'train_acc': 0.9448122504674786, 'train_auc': 0.9845032236640442, 'test_acc': 0.9808129260287806, 'test_auc': 0.9980354411014788, 'test_f1_score': 0.9804727646454264, 'test_recall': 0.972972972972973} , 2024-03-11 15:26:08.248233
# epoch:5 , cost_time:87.88246750831604 , {'train_acc': 0.9685652195886187, 'train_auc': 0.9919240727495657, 'test_acc': 0.9825801565261297, 'test_auc': 0.9974227434982151, 'test_f1_score': 0.9822758797842281, 'test_recall': 0.9750127485976543} , 2024-03-11 15:27:44.469108
# epoch:6 , cost_time:85.61112666130066 , {'train_acc': 0.9686662960529641, 'train_auc': 0.9925348881168896, 'test_acc': 0.9823276950265084, 'test_auc': 0.9979945181030087, 'test_f1_score': 0.9820604818042029, 'test_recall': 0.9770525242223356} , 2024-03-11 15:29:19.687940
# epoch:7 , cost_time:95.11085724830627 , {'train_acc': 0.9755900338606156, 'train_auc': 0.9944726116276693, 'test_acc': 0.9820752335268872, 'test_auc': 0.9977646608873023, 'test_f1_score': 0.9817621371692782, 'test_recall': 0.974502804691484} , 2024-03-11 15:31:03.383449
# epoch:8 , cost_time:92.93645119667053 , {'train_acc': 0.9777126396118664, 'train_auc': 0.9942456268519465, 'test_acc': 0.9810653875284019, 'test_auc': 0.99767809790923, 'test_f1_score': 0.9807247494217425, 'test_recall': 0.972972972972973} , 2024-03-11 15:32:45.968886
# epoch:9 , cost_time:62.90132546424866 , {'train_acc': 0.979582554202254, 'train_auc': 0.9945237049146828, 'test_acc': 0.9823276950265084, 'test_auc': 0.9979062978072412, 'test_f1_score': 0.9820880245649948, 'test_recall': 0.9785823559408465} , 2024-03-11 15:33:57.739464
# epoch:10 , cost_time:107.04133725166321 , {'train_acc': 0.9802900894526709, 'train_auc': 0.9958733013180749, 'test_acc': 0.9828326180257511, 'test_auc': 0.9976687914329424, 'test_f1_score': 0.9825641025641026, 'test_recall': 0.9770525242223356} , 2024-03-11 15:35:53.954131
# epoch:11 , cost_time:99.05918383598328 , {'train_acc': 0.9749835750745439, 'train_auc': 0.9946669408398896, 'test_acc': 0.9823276950265084, 'test_auc': 0.99711983681795, 'test_f1_score': 0.9821246169560777, 'test_recall': 0.9806221315655278} , 2024-03-11 15:37:42.024838
# epoch:12 , cost_time:84.45098567008972 , {'train_acc': 0.9785212513266286, 'train_auc': 0.9941194441606211, 'test_acc': 0.9815703105276445, 'test_auc': 0.9975225650178481, 'test_f1_score': 0.9812001030131342, 'test_recall': 0.971443141254462} , 2024-03-11 15:39:15.602052
# epoch:13 , cost_time:87.62872767448425 , {'train_acc': 0.9816546217213322, 'train_auc': 0.9958106569939715, 'test_acc': 0.9798030800302954, 'test_auc': 0.9977591789903111, 'test_f1_score': 0.9797673242286292, 'test_recall': 0.9877613462519123} , 2024-03-11 15:40:51.256249
# epoch:14 , cost_time:61.6044340133667 , {'train_acc': 0.9805427806135342, 'train_auc': 0.995373214468172, 'test_acc': 0.976268619035597, 'test_auc': 0.9978796532381438, 'test_f1_score': 0.9755335762623634, 'test_recall': 0.9556348801631821} , 2024-03-11 15:42:01.514425
# epoch:15 , cost_time:56.3654088973999 , {'train_acc': 0.9818567746500227, 'train_auc': 0.9952317615203843, 'test_acc': 0.9810653875284019, 'test_auc': 0.9975863080061194, 'test_f1_score': 0.9806750837413037, 'test_recall': 0.9704232534421213} , 2024-03-11 15:43:06.504514
# epoch:16 , cost_time:104.83419489860535 , {'train_acc': 0.9767018749684137, 'train_auc': 0.994335102687238, 'test_acc': 0.9818227720272659, 'test_auc': 0.9977862060173381, 'test_f1_score': 0.9814814814814815, 'test_recall': 0.972972972972973} , 2024-03-11 15:44:59.673022
# epoch:17 , cost_time:68.92449069023132 , {'train_acc': 0.9805427806135342, 'train_auc': 0.9955069224481455, 'test_acc': 0.9825801565261297, 'test_auc': 0.997977180010199, 'test_f1_score': 0.9822849807445443, 'test_recall': 0.9755226925038246} , 2024-03-11 15:46:17.127044
# epoch:18 , cost_time:72.52361917495728 , {'train_acc': 0.981401930560469, 'train_auc': 0.9954840758148564, 'test_acc': 0.9830850795253724, 'test_auc': 0.9977112442631311, 'test_f1_score': 0.9828337176530875, 'test_recall': 0.9780724120346762} , 2024-03-11 15:47:39.435490
# epoch:19 , cost_time:95.35395884513855 , {'train_acc': 0.9779653307727296, 'train_auc': 0.9955007867579442, 'test_acc': 0.9767735420348397, 'test_auc': 0.9978735339112698, 'test_f1_score': 0.9761038961038961, 'test_recall': 0.9581845996940337} , 2024-03-11 15:49:23.148586
# epoch:20 , cost_time:61.384135484695435 , {'train_acc': 0.9804417041491889, 'train_auc': 0.9953111423316645, 'test_acc': 0.9792981570310527, 'test_auc': 0.9974748852626212, 'test_f1_score': 0.9788550799381124, 'test_recall': 0.9678735339112697} , 2024-03-11 15:50:33.457705
# epoch:21 , cost_time:87.59174227714539 , {'train_acc': 0.9781674837014201, 'train_auc': 0.9945052978440789, 'test_acc': 0.9805604645291593, 'test_auc': 0.9978811830698623, 'test_f1_score': 0.9805112629713996, 'test_recall': 0.9877613462519123} , 2024-03-11 15:52:09.362486
# epoch:22 , cost_time:66.88290500640869 , {'train_acc': 0.9806438570778794, 'train_auc': 0.9949271073873506, 'test_acc': 0.9823276950265084, 'test_auc': 0.9977983171851096, 'test_f1_score': 0.9822695035460992, 'test_recall': 0.9887812340642529} , 2024-03-11 15:53:24.795342
# epoch:23 , cost_time:92.42258191108704 , {'train_acc': 0.9799868600596351, 'train_auc': 0.9950859200980893, 'test_acc': 0.980462004544307, 'test_auc': 0.9973656297807241, 'test_f1_score': 0.989395762490191, 'test_recall': 0.9849260581336053} , 2024-03-11 15:55:06.942315
# epoch:24 , cost_time:97.08570098876953 , {'train_acc': 0.9796836306665992, 'train_auc': 0.9952966843772351, 'test_acc': 0.9828326180257511, 'test_auc': 0.9976191993880673, 'test_f1_score': 0.982741116751269, 'test_recall': 0.9872514023457419} , 2024-03-11 15:56:53.146567
# epoch:25 , cost_time:98.27864050865173 , {'train_acc': 0.9746298074493355, 'train_auc': 0.9944052671911721, 'test_acc': 0.9787932340318102, 'test_auc': 0.9975289393166752, 'test_f1_score': 0.9787449392712549, 'test_recall': 0.9862315145334013} , 2024-03-11 15:58:40.995178
# epoch:26 , cost_time:59.72103023529053 , {'train_acc': 0.9799363218274625, 'train_auc': 0.9944441095330541, 'test_acc': 0.9833375410249937, 'test_auc': 0.9977525497195309, 'test_f1_score': 0.9832317073170731, 'test_recall': 0.9867414584395716} , 2024-03-11 15:59:49.297173
# epoch:27 , cost_time:83.65009832382202 , {'train_acc': 0.9784201748622833, 'train_auc': 0.9944748339634208, 'test_acc': 0.9823276950265084, 'test_auc': 0.9977163437021928, 'test_f1_score': 0.982115482881962, 'test_recall': 0.9801121876593575} , 2024-03-11 16:01:21.514606
# epoch:28 , cost_time:70.5728816986084 , {'train_acc': 0.9799363218274625, 'train_auc': 0.9946498314090119, 'test_acc': 0.9828326180257511, 'test_auc': 0.9977679755226926, 'test_f1_score': 0.9826795720835456, 'test_recall': 0.9836817950025497} , 2024-03-11 16:02:41.225820
# epoch:29 , cost_time:99.45617723464966 , {'train_acc': 0.9791782483448729, 'train_auc': 0.9956898181260856, 'test_acc': 0.9843473870234789, 'test_auc': 0.9977209331973482, 'test_f1_score': 0.984167517875383, 'test_recall': 0.9826619071902091} , 2024-03-11 16:04:29.495564
# '''
# lightgbm = '''
# epoch:0 , {'cost_time': 633.2050034999847, 'test_acc': 0.8911890936632164, 'test_auc': 0.9964696583375829, 'test_f1_score': 0.8766103635843115, 'test_recall': 0.7807241203467619} , 2024-03-11 22:37:19.319117
# epoch:1 , {'cost_time': 604.0318496227264, 'test_acc': 0.8911890936632164, 'test_auc': 0.9964696583375829, 'test_f1_score': 0.8766103635843115, 'test_recall': 0.7807241203467619} , 2024-03-11 22:47:23.369904
# epoch:2 , {'cost_time': 572.7068295478821, 'test_acc': 0.8911890936632164, 'test_auc': 0.9964696583375829, 'test_f1_score': 0.8766103635843115, 'test_recall': 0.7807241203467619} , 2024-03-11 22:56:56.095697
# epoch:3 , {'cost_time': 573.9401125907898, 'test_acc': 0.8911890936632164, 'test_auc': 0.9964696583375829, 'test_f1_score': 0.8766103635843115, 'test_recall': 0.7807241203467619} , 2024-03-11 23:06:30.054394
# epoch:4 , {'cost_time': 572.177604675293, 'test_acc': 0.8911890936632164, 'test_auc': 0.9964696583375829, 'test_f1_score': 0.8766103635843115, 'test_recall': 0.7807241203467619} , 2024-03-11 23:16:02.250570
# epoch:5 , {'cost_time': 573.8874356746674, 'test_acc': 0.8911890936632164, 'test_auc': 0.9964696583375829, 'test_f1_score': 0.8766103635843115, 'test_recall': 0.7807241203467619} , 2024-03-11 23:25:36.156620
# epoch:6 , {'cost_time': 573.7059524059296, 'test_acc': 0.8911890936632164, 'test_auc': 0.9964696583375829, 'test_f1_score': 0.8766103635843115, 'test_recall': 0.7807241203467619} , 2024-03-11 23:35:09.881271
# epoch:7 , {'cost_time': 573.3828160762787, 'test_acc': 0.8911890936632164, 'test_auc': 0.9964696583375829, 'test_f1_score': 0.8766103635843115, 'test_recall': 0.7807241203467619} , 2024-03-11 23:44:43.282948
# epoch:8 , {'cost_time': 573.9546248912811, 'test_acc': 0.8911890936632164, 'test_auc': 0.9964696583375829, 'test_f1_score': 0.8766103635843115, 'test_recall': 0.7807241203467619} , 2024-03-11 23:54:17.256236
# epoch:9 , {'cost_time': 575.5913641452789, 'test_acc': 0.8911890936632164, 'test_auc': 0.9964696583375829, 'test_f1_score': 0.8766103635843115, 'test_recall': 0.7807241203467619} , 2024-03-12 00:03:52.866191
# epoch:10 , {'cost_time': 576.9326331615448, 'test_acc': 0.8911890936632164, 'test_auc': 0.9964696583375829, 'test_f1_score': 0.8766103635843115, 'test_recall': 0.7807241203467619} , 2024-03-12 00:13:29.818207
# epoch:11 , {'cost_time': 576.0967390537262, 'test_acc': 0.8911890936632164, 'test_auc': 0.9964696583375829, 'test_f1_score': 0.8766103635843115, 'test_recall': 0.7807241203467619} , 2024-03-12 00:23:05.933580
# epoch:12 , {'cost_time': 575.5353910923004, 'test_acc': 0.8911890936632164, 'test_auc': 0.9964696583375829, 'test_f1_score': 0.8766103635843115, 'test_recall': 0.7807241203467619} , 2024-03-12 00:32:41.487897
# epoch:13 , {'cost_time': 575.9323132038116, 'test_acc': 0.8911890936632164, 'test_auc': 0.9964696583375829, 'test_f1_score': 0.8766103635843115, 'test_recall': 0.7807241203467619} , 2024-03-12 00:42:17.438844
# epoch:14 , {'cost_time': 574.7362778186798, 'test_acc': 0.8911890936632164, 'test_auc': 0.9964696583375829, 'test_f1_score': 0.8766103635843115, 'test_recall': 0.7807241203467619} , 2024-03-12 00:51:52.195967
# epoch:15 , {'cost_time': 574.6232633590698, 'test_acc': 0.8911890936632164, 'test_auc': 0.9964696583375829, 'test_f1_score': 0.8766103635843115, 'test_recall': 0.7807241203467619} , 2024-03-12 01:01:26.837914
# epoch:16 , {'cost_time': 573.8366632461548, 'test_acc': 0.8911890936632164, 'test_auc': 0.9964696583375829, 'test_f1_score': 0.8766103635843115, 'test_recall': 0.7807241203467619} , 2024-03-12 01:11:00.693493
# epoch:17 , {'cost_time': 573.822678565979, 'test_acc': 0.8911890936632164, 'test_auc': 0.9964696583375829, 'test_f1_score': 0.8766103635843115, 'test_recall': 0.7807241203467619} , 2024-03-12 01:20:34.534788
# epoch:18 , {'cost_time': 574.5636279582977, 'test_acc': 0.8911890936632164, 'test_auc': 0.9964696583375829, 'test_f1_score': 0.8766103635843115, 'test_recall': 0.7807241203467619} , 2024-03-12 01:30:09.118739
# epoch:19 , {'cost_time': 573.7860698699951, 'test_acc': 0.8911890936632164, 'test_auc': 0.9964696583375829, 'test_f1_score': 0.8766103635843115, 'test_recall': 0.7807241203467619} , 2024-03-12 01:39:42.923434
# epoch:20 , {'cost_time': 574.5567758083344, 'test_acc': 0.8911890936632164, 'test_auc': 0.9964696583375829, 'test_f1_score': 0.8766103635843115, 'test_recall': 0.7807241203467619} , 2024-03-12 01:49:17.499086
# epoch:21 , {'cost_time': 574.245489358902, 'test_acc': 0.8911890936632164, 'test_auc': 0.9964696583375829, 'test_f1_score': 0.8766103635843115, 'test_recall': 0.7807241203467619} , 2024-03-12 01:58:51.763236
# epoch:22 , {'cost_time': 573.7590575218201, 'test_acc': 0.8911890936632164, 'test_auc': 0.9964696583375829, 'test_f1_score': 0.8766103635843115, 'test_recall': 0.7807241203467619} , 2024-03-12 02:08:25.540941
# epoch:23 , {'cost_time': 574.1309654712677, 'test_acc': 0.8911890936632164, 'test_auc': 0.9964696583375829, 'test_f1_score': 0.8766103635843115, 'test_recall': 0.7807241203467619} , 2024-03-12 02:17:59.690558
# epoch:24 , {'cost_time': 575.2206513881683, 'test_acc': 0.8911890936632164, 'test_auc': 0.9964696583375829, 'test_f1_score': 0.8766103635843115, 'test_recall': 0.7807241203467619} , 2024-03-12 02:27:34.929954
# epoch:25 , {'cost_time': 569.9685080051422, 'test_acc': 0.8911890936632164, 'test_auc': 0.9964696583375829, 'test_f1_score': 0.8766103635843115, 'test_recall': 0.7807241203467619} , 2024-03-12 02:37:04.917139
# epoch:26 , {'cost_time': 569.6407554149628, 'test_acc': 0.8911890936632164, 'test_auc': 0.9964696583375829, 'test_f1_score': 0.8766103635843115, 'test_recall': 0.7807241203467619} , 2024-03-12 02:46:34.576670
# epoch:27 , {'cost_time': 568.5413873195648, 'test_acc': 0.8911890936632164, 'test_auc': 0.9964696583375829, 'test_f1_score': 0.8766103635843115, 'test_recall': 0.7807241203467619} , 2024-03-12 02:56:03.136737
# epoch:28 , {'cost_time': 568.5295009613037, 'test_acc': 0.8911890936632164, 'test_auc': 0.9964696583375829, 'test_f1_score': 0.8766103635843115, 'test_recall': 0.7807241203467619} , 2024-03-12 03:05:31.684944
# epoch:29 , {'cost_time': 567.9641659259796, 'test_acc': 0.8911890936632164, 'test_auc': 0.9964696583375829, 'test_f1_score': 0.8766103635843115, 'test_recall': 0.7807241203467619} , 2024-03-12 03:14:59.667836
# '''

def plt_compare_picture(name,malconv2_data,attention_gru_data,CAG_malconv):
    # 获取当前日月
    time_str = time.strftime("%Y-%m-%d", time.localtime())
    dir  = f'/home/fhh/ember-master/MalConv2-main/compare_pictures/{time_str}'
    if not os.path.exists(dir):
        os.makedirs(dir)

    plt.figure(figsize=(10, 5))
    plt.plot(malconv2_data, label='Malconv2')
    plt.plot(attention_gru_data, label='CAG-malconv')
    plt.plot(CAG_malconv, label='LightGBM')
    plt.title(name)
    plt.legend()
    plt.savefig(dir + '/' + name +'.png')

if __name__ == '__main__':
    
    malconv2_result_test_acc = []
    malconv2_result_test_auc = []
    malconv2_result_test_f1_score = []
    malconv2_result_test_recall = []

    CAG_malconv_result_test_acc = []
    CAG_malconv_result_test_auc = []
    CAG_malconv_result_test_f1_score = []
    CAG_malconv_result_test_recall = []

    lightgbm_result_test_acc = []
    lightgbm_result_test_auc = []
    lightgbm_result_test_f1_score = []
    lightgbm_result_test_recall = []


    for line in malconv2_result.split('\n'):
        if line:
            line = line.split(',')
            malconv2_result_test_acc.append(float(line[4].split(':')[1]))
            malconv2_result_test_auc.append(float(line[5].split(':')[1]))
            malconv2_result_test_f1_score.append(float(line[6].split(':')[1]))
            malconv2_result_test_recall.append(float((line[7].split(':')[1]).strip().removesuffix('}')))


    for line in CAG_malconv.split('\n'):
        if line:
            line = line.split(',')
            CAG_malconv_result_test_auc.append(float(line[5].split(':')[1]))
            CAG_malconv_result_test_acc.append(float(line[4].split(':')[1]))
            CAG_malconv_result_test_f1_score.append(float(line[6].split(':')[1]))
            CAG_malconv_result_test_recall.append(float((line[7].split(':')[1]).strip().removesuffix('}')))
    
    for line in lightgbm.split('\n'):
        if line:
            line = line.split(',')
            lightgbm_result_test_acc.append(float(line[2].split(':')[1]))
            lightgbm_result_test_auc.append(float(line[3].split(':')[1]))
            lightgbm_result_test_f1_score.append(float(line[4].split(':')[1]))
            lightgbm_result_test_recall.append(float((line[5].split(':')[1]).strip().removesuffix('}')))

    plt_compare_picture('Acc',malconv2_result_test_acc,CAG_malconv_result_test_acc,lightgbm_result_test_acc)
    plt_compare_picture('Auc',malconv2_result_test_auc,CAG_malconv_result_test_auc,lightgbm_result_test_auc)
    plt_compare_picture('F1_score',malconv2_result_test_f1_score,CAG_malconv_result_test_f1_score,lightgbm_result_test_f1_score)
    plt_compare_picture('Recall',malconv2_result_test_recall,CAG_malconv_result_test_recall,lightgbm_result_test_recall)


    print('Done!')





